<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Make a Payment</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 100px;
      background-color: #f5f5f5;
    }
  </style>
</head>
<body>
  <h1>Make a Payment</h1>
  <p>Click the button below to pay with Google Pay.</p>
  <div id="container"></div>

  <!-- Load Google Pay API -->
  <script src="https://pay.google.com/gp/p/js/pay.js" async onload="onGooglePayLoaded()"></script>

  <script>
    function onGooglePayLoaded() {
      console.log("Google Pay script loaded.");
      try {
        const paymentsClient = new google.payments.api.PaymentsClient({ environment: 'PRODUCTION' });
        const button = paymentsClient.createButton({
          onClick: onGooglePayButtonClicked,
          buttonColor: 'default',
          buttonType: 'long'
        });
        document.getElementById('container').appendChild(button);
        console.log("Google Pay button added to container.");
      } catch (error) {
        console.error("Error initializing Google Pay button:", error);
      }
    }

    function onGooglePayButtonClicked() {
      console.log("Google Pay button clicked. Initiating payment...");
      const paymentsClient = new google.payments.api.PaymentsClient({ environment: 'PRODUCTION' });
      const paymentDataRequest = getPaymentDataRequest();

      paymentsClient.loadPaymentData(paymentDataRequest)
        .then(function(paymentData) {
          console.log("Payment data received:", paymentData);
          processPayment(paymentData);
        })
        .catch(function(err) {
          console.error("Error loading payment data:", err);
          alert('Unable to initiate payment. Please try again.');
        });
    }

    function getPaymentDataRequest() {
      return {
        apiVersion: 2,
        apiVersionMinor: 0,
        allowedPaymentMethods: [{
          supportedMethods: 'https://tez.google.com/pay',
          data: {
            pa: '9469050879@ptsbi',  // Your UPI ID
            pn: 'HSS Shangus',       // Merchant Name
            tr: 'txn_' + new Date().getTime(), // Unique transaction reference ID
            url: 'https://shgulfam.github.io/e-Educational/',
            mc: '5045',              // Merchant category code
            tn: 'Admission Fee'
          }
        }],
        transactionInfo: {
          totalPriceStatus: 'FINAL',
          totalPrice: '10.01',
          currencyCode: 'INR'
        },
        merchantInfo: {
          merchantName: 'Sheikh Gulfam'
        }
      };
    }

    function processPayment(paymentData) {
      console.log("Processing payment data...");
      // Simulate a successful payment for testing.
      alert('Payment successful! Payment data: ' + JSON.stringify(paymentData));
    }
  </script>
</body>
</html>
